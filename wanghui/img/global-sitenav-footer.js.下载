var userStr,userContainer=document.getElementById("userInfo"),userLoginLinks=document.getElementById("sitenav-login-links");var loginZolInterFaceUrl="//dynamic.zol.com.cn/channel/userLoginIndex.php";var zolInterFaceUrl="//service.zol.com.cn/user/api/login_zol.php?";var iqiyiILogUrl="//zol.iqiyi.com.cn/?c=Api_Login";var iqiyApiUrl="//zol.iqiyi.com.cn/?c=Api_Login&a=APILogin";var iqiyi=false;if(location.hostname=="zol.iqiyi.com.cn"&&(document.doamin=="zol.com.cn"||document.domain=="zol.iqiyi.com.cn")){loginZolInterFaceUrl=iqiyiILogUrl;iqiyi=true}$(function(){if($(".znav_list").length>0){$(".sitenav-groupsite").remove();$("#zhead .znav").remove();$("#zhead .zlogin").remove()}$("#add-fav").click(function(e){__publicNav.addFav(e)});if(userid){__publicNav.loginSuccess(userid)}else{var d=typeof(d)!="undefined"?d:document.URL;userStr='<div class="sitenav-login-links">'+'<a href="//service.zol.com.cn/user/api/weixin/jump.php?backurl='+encodeURIComponent(d)+'" target="_blank" class="sitenav-weixin" title="\u4f7f\u7528\u5fae\u4fe1\u767b\u5f55"><i></i></a>'+' <a href="//service.zol.com.cn/user/api/sina/jump.php?from=220" target="_blank" class="sitenav-weibo" title="\u4f7f\u7528\u65b0\u6d6a\u5fae\u535a\u767b\u5f55"><i></i></a>'+' <a href="//service.zol.com.cn/user/api/qq/libs/oauth/redirect_to_login.php?from=220&backurl='+encodeURIComponent(d)+'" target="_blank" class="sitenav-qq" title="\u4f7f\u7528\u817e\u8bafQQ\u767b\u5f55"><i></i></a>'+"</div>";$(document).click(function(g){g=window.event||g;obj=$(g.srcElement||g.target);if(obj.parents("#sitenavLoginBox").length==1||obj.attr("class")=="sitenav-login-form"||obj.attr("class")=="sitenav-login-link"){}else{$(".sitenav-login-form").hide()}});$("#sitenavLoginBox").live("dblclick",function(g){g=window.event||g;obj=g.srcElement||g.target;if($(obj).attr("id")=="sitenavLoginBox"){$(".sitenav-login-form").hide()}});var c=true;$(".sitenav-login-link").live("click",function(){if($(".sitenav-login-form").css("display")=="none"){$(".sitenav-login-form").show();$("#userName").focus()}else{$(".sitenav-login-form").hide()}if(c){$("#zol-login-framebox").attr("src",loginFrameApiUrl);var e=document.createElement("script");e.type="text/javascript";e.src="//service.zol.com.cn/user/js/login2014/md5.js";document.getElementsByTagName("body")[0].appendChild(e);c=false}});$("#userName").live("keyup",function(e){var g=$(this).val();if(g){$(this).siblings('label[for="userName"]').hide()}else{$(this).siblings('label[for="userName"]').show()}if(e.keyCode==13){return false}$("#sitenav-mes-tip").removeClass("sitenav-error-tip").html("\u5e10\u53f7\u767b\u5f55")});$("#passWord").live("keyup",function(e){var g=$(this).val();$("#sitenav-mes-tip").removeClass("sitenav-error-tip").html("\u5e10\u53f7\u767b\u5f55");if(g){$(this).siblings('label[for="passWord"]').hide()}else{$(this).siblings('label[for="passWord"]').show()}if(e.keyCode==13){return false}$("#sitenav-mes-tip").removeClass("sitenav-error-tip").html("\u5e10\u53f7\u767b\u5f55")});$("#userName, #passWord").focus(function(){$(this).css({cursor:"text"});$(this).siblings("label").css({cursor:"text"});$(this).parent("div").siblings("div").removeClass("sitenav-focus");$(this).parent("div").siblings("div").removeClass("sitenav-error");$(this).parent("div").addClass("sitenav-focus")});var b=true;$("#sitenav-login-button").click(function(){var g=$("#userName").val(),e=$("#passWord").val(),h="";if($("#autoLogin").is(":checked")){h=1}g=__publicNav.trim(g);e=__publicNav.trim(e);if(!b){return false}$("#passWord").attr("mds",CryptoJS.MD5(e+"zol"));e=$("#passWord").attr("mds");if(g&&e){b=false;$.ajax({type:"GET",url:loginZolInterFaceUrl,async:false,data:{userid:g,password:e,isAuto:h,r:Math.random()},dataType:"jsonp",success:function(j){if(j.code<1){if(iqiyi){$.getJSON(zolInterFaceUrl+"&callback=?",{act:"signin",username:j.shopUserId,check:j.shopStr},function(k){})}else{$.getJSON(iqiyApiUrl+"&callback=?",{act:"signin",username:j.shopUserId,check:j.shopStr},function(k){})}var i="//login.zol.com/index.php?callback=?&c=Default&a=APILogin&act=signin&username="+j.shopUserId+"&check="+j.shopStr;$.getJSON(i,function(k){setTimeout(function(){if(typeof(__publicNavRefresh)!="undefined"&&__publicNavRefresh){window.location.reload(true)}__publicNav.loginSuccess(g)},1000)})}else{$("#sitenav-mes-tip").addClass("sitenav-error-tip").html(j.message);$("div.sitenav-username").removeClass("sitenav-focus");$("div.sitenav-password").removeClass("sitenav-focus");switch(j.subCode){case 2:$("div.sitenav-username").addClass("sitenav-error");$("div.sitenav-password").addClass("sitenav-error");break;case 3:$("div.sitenav-username").addClass("sitenav-error");break;default:$("#sitenav-mes-tip").addClass("sitenav-error-tip").html("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002")}}b=true},error:function(i){b=true}})}else{$("#sitenav-mes-tip").addClass("sitenav-error-tip").html("\u8bf7\u5c06\u7528\u6237\u540d\u548c\u5bc6\u7801\u586b\u5199\u5b8c\u6574\u3002")}return false});$(".sitenav-login-form input").live("keyup",function(e){if(e.keyCode==13){$("#sitenav-login-button").trigger("click");return false}})}try{$.chgVestCallback=function(){var e='<span id="siteVestBtn"style="line-height:30px;padding-right:5px;cursor:pointer;">';e+="\u5207\u9a6c\u7532</span>";$(".sitenav-personal-welcome").prepend(e)};var a=document.createElement("script");a.src="//icon.zol-img.com.cn/service/js/chgvest.js";a.setAttribute("data-id","editVestChange");a.setAttribute("data-param",'{"id":"siteVestBtn","callback":"$.chgVestCallback"}');document.body.appendChild(a)}catch(f){}});